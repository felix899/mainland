# 酒店結構重構指南

## 概述
本次重構將期間（Period）模型重新設計為多層次結構，使數據組織更加清晰和靈活。

## 新的模型結構

### 層級架構
```
Package (套票)
  └─ Period (期間)
       └─ Hotel (酒店)
            └─ RoomType (房型)
                 ├─ RoomPrice (房間價格) - 可多筆
                 └─ RoomImage (房間圖片) - 可多筆
```

## 模型詳細說明

### 1. Period (期間)
- **用途**: 定義套票的時間段
- **欄位**: 
  - `period_text`: 期間文字（例如：第1天、第2-3天）
  - `is_active`: 是否啟用
- **關聯**: 屬於 Package

### 2. Hotel (酒店)
- **用途**: 定義期間內的酒店資訊
- **欄位**: 
  - `hotel_name`: 酒店名稱
  - `is_active`: 是否啟用
- **關聯**: 屬於 Period
- **特點**: 一個期間可以有多個酒店

### 3. RoomType (房型)
- **用途**: 定義酒店的房間類型
- **欄位**: 
  - `room_type_name`: 房型名稱（例如：標準房、豪華房）
  - `is_active`: 是否啟用
- **關聯**: 屬於 Hotel（外鍵）
- **特點**: 一個酒店可以有多個房型

### 4. RoomPrice (房間價格)
- **用途**: 定義房型的價格
- **欄位**: 
  - `price`: 價格
  - `price_description`: 價格說明（例如：旺季價格、淡季價格）
  - `is_active`: 是否啟用
- **關聯**: 屬於 RoomType（外鍵）
- **特點**: 一個房型可以有多個價格（不同季節、優惠等）

### 5. RoomImage (房間圖片)
- **用途**: 存儲房型的圖片
- **欄位**: 
  - `image`: 圖片檔案
  - `image_description`: 圖片說明
  - `is_active`: 是否啟用
- **關聯**: 屬於 RoomType（外鍵）
- **特點**: 一個房型可以有多個圖片

## Admin 後台整合

所有內容都已整合到 Package 管理頁面中，使用嵌套的 inline 編輯器：

### 使用方式
1. 進入 Package 編輯頁面
2. 在「期間」區塊中添加期間
3. 在每個期間下添加酒店
4. 在每個酒店下添加房型
5. 在每個房型下添加：
   - 多個價格（不同季節/優惠）
   - 多個圖片（不同角度/房間設施）

### 功能特色
- **完整嵌套編輯**: 在一個頁面完成所有資料輸入
- **可展開/收合**: 使用 collapse 類別優化界面
- **快速連結**: 可透過 "查看連結" 跳轉到詳細編輯頁面
- **獨立管理**: 每個模型也可以在獨立頁面進行管理

## 資料遷移

執行以下命令已完成：
```bash
python manage.py makemigrations
python manage.py migrate
```

遷移檔案: `0024_hotel_roomimage_roomprice_roomtype_and_more.py`

## 注意事項

1. **舊資料**: `Period` 的 `hotel_name`, `room_type`, `image`, `price` 欄位已移除
2. **已刪除模型**: `PeriodHotelInfo` 已刪除
3. **views.py 更新**: prefetch_related 查詢已更新以使用新結構
4. **複製功能**: Package 的 `copy_package()` 方法已更新以支援新結構

## 優勢

1. **更好的數據組織**: 清晰的層級結構
2. **靈活性**: 
   - 一個期間可以有多個酒店
   - 一個酒店可以有多個房型
   - 一個房型可以有多個價格和圖片
3. **易於維護**: 每個概念都有專屬的模型
4. **可擴展性**: 未來可輕鬆添加更多屬性

## 範例使用情境

### 情境 1: 多酒店選擇
某個 3 天 2 夜套票，每晚可選擇不同酒店：
- 期間: 第1天
  - 酒店A
  - 酒店B
  - 酒店C

### 情境 2: 多房型選擇
某個酒店提供多種房型：
- 酒店: 海濱度假村
  - 房型: 標準房
  - 房型: 海景房
  - 房型: 豪華套房

### 情境 3: 季節性價格
同一房型有不同季節價格：
- 房型: 海景房
  - 價格: TWD 5,000 (淡季)
  - 價格: TWD 8,000 (旺季)
  - 價格: TWD 6,500 (週末)

### 情境 4: 多張房間圖片
展示房間的不同角度：
- 房型: 豪華套房
  - 圖片: 臥室全景
  - 圖片: 浴室
  - 圖片: 陽台海景
  - 圖片: 客廳

