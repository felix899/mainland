# å¤§é™¸å±¤ç´šé·ç§»æŒ‡å—

## æ¦‚è¿°

ç³»çµ±å·²æˆåŠŸæ·»åŠ ã€Œå¤§é™¸ã€ï¼ˆContinentï¼‰å±¤ç´šï¼Œæ–°çš„å±¤ç´šçµæ§‹ç‚ºï¼š

**å¤§é™¸ï¼ˆContinentï¼‰â†’ åœ‹å®¶ï¼ˆCountryï¼‰â†’ åŸå¸‚ï¼ˆCityï¼‰â†’ å¥—ç¥¨ï¼ˆPackageï¼‰**

## å·²å®Œæˆçš„æ›´æ–°

### 1. æ¨¡å‹æ›´æ–° (models.py)
- âœ… æ–°å¢ `Continent` æ¨¡å‹
- âœ… `Country` æ¨¡å‹æ·»åŠ  `continent` å¤–éµå­—æ®µ
- âœ… æ›´æ–°æ‰€æœ‰ `get_absolute_url()` æ–¹æ³•ä»¥æ”¯æŒå¤§é™¸å±¤ç´š

### 2. URL è·¯ç”±æ›´æ–° (urls.py)
æ–°çš„ URL çµæ§‹ï¼š
- `/packages/` - æ‰€æœ‰å¥—ç¥¨
- `/packages/<continent_slug>/` - æŒ‰å¤§é™¸ç¯©é¸
- `/packages/<continent_slug>/<country_slug>/` - æŒ‰åœ‹å®¶ç¯©é¸
- `/packages/<continent_slug>/<country_slug>/<city_slug>/` - æŒ‰åŸå¸‚ç¯©é¸
- `/packages/<continent_slug>/<country_slug>/<city_slug>/<package_slug>/` - å¥—ç¥¨è©³æƒ…

### 3. è¦–åœ–æ›´æ–° (views.py)
- âœ… æ–°å¢ `package_list_by_continent()` è¦–åœ–
- âœ… æ›´æ–°æ‰€æœ‰ç¾æœ‰è¦–åœ–ä»¥æ”¯æŒå¤§é™¸åƒæ•¸
- âœ… å„ªåŒ–æŸ¥è©¢æ€§èƒ½ï¼ˆselect_related åŒ…å« continentï¼‰

### 4. æ¨¡æ¿æ›´æ–° (package_list.html)
- âœ… æ·»åŠ å¤§é™¸å¾½ç« é¡¯ç¤º
- âœ… æ›´æ–° URL ç”Ÿæˆé‚è¼¯
- âœ… æ·»åŠ  `.badge-continent` CSS æ¨£å¼

### 5. ç®¡ç†å¾Œå°æ›´æ–° (admin.py)
- âœ… æ–°å¢ `ContinentAdmin` ç®¡ç†ç•Œé¢
- âœ… æ›´æ–° `CountryAdmin` ä»¥é¡¯ç¤ºæ‰€å±¬å¤§é™¸
- âœ… æ›´æ–° `PackageAdmin` ä»¥æ”¯æŒæŒ‰å¤§é™¸ç¯©é¸

### 6. æ•¸æ“šåº«é·ç§»
- âœ… å‰µå»ºé·ç§»æ–‡ä»¶ï¼š`0012_continent_alter_country_slug_country_continent_and_more.py`

## ä½¿ç”¨æ­¥é©Ÿ

### æ­¥é©Ÿ 1ï¼šåŸ·è¡Œæ•¸æ“šåº«é·ç§»

```bash
cd cms
python manage.py migrate
```

### æ­¥é©Ÿ 2ï¼šåœ¨ç®¡ç†å¾Œå°æ·»åŠ å¤§é™¸æ•¸æ“š

1. è¨ªå•ç®¡ç†å¾Œå°ï¼šhttp://127.0.0.1:8000/admin/
2. é»æ“Šã€Œå¤§é™¸ã€â†’ã€Œæ–°å¢å¤§é™¸ã€
3. æ·»åŠ å¤§é™¸æ•¸æ“šï¼Œä¾‹å¦‚ï¼š
   - åç¨±ï¼šäºæ´²
   - è‹±æ–‡åç¨±ï¼šAsia
   - URL ä»£ç¢¼ï¼šasiaï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰

å¸¸è¦‹çš„å¤§é™¸ï¼š
- äºæ´² (Asia) - slug: asia
- æ­æ´² (Europe) - slug: europe
- åŒ—ç¾æ´² (North America) - slug: north-america
- å—ç¾æ´² (South America) - slug: south-america
- éæ´² (Africa) - slug: africa
- å¤§æ´‹æ´² (Oceania) - slug: oceania

### æ­¥é©Ÿ 3ï¼šæ›´æ–°ç¾æœ‰åœ‹å®¶æ•¸æ“š

1. é€²å…¥ã€Œåœ‹å®¶ã€ç®¡ç†ç•Œé¢
2. ç·¨è¼¯æ¯å€‹åœ‹å®¶
3. é¸æ“‡å°æ‡‰çš„ã€Œæ‰€å±¬å¤§é™¸ã€
4. ä¿å­˜

### æ­¥é©Ÿ 4ï¼šæ¸¬è©¦æ–°çš„ URL çµæ§‹

è¨ªå•ä»¥ä¸‹ URL æ¸¬è©¦ï¼š
- http://127.0.0.1:8000/packages/ ï¼ˆæ‰€æœ‰å¥—ç¥¨ï¼‰
- http://127.0.0.1:8000/packages/asia/ ï¼ˆäºæ´²çš„å¥—ç¥¨ï¼‰
- http://127.0.0.1:8000/packages/asia/japan/ ï¼ˆæ—¥æœ¬çš„å¥—ç¥¨ï¼‰
- http://127.0.0.1:8000/packages/asia/japan/okinawa/ ï¼ˆæ²–ç¹©çš„å¥—ç¥¨ï¼‰
- http://127.0.0.1:8000/packages/asia/japan/okinawa/diving-course/ ï¼ˆå…·é«”å¥—ç¥¨ï¼‰

## æ³¨æ„äº‹é …

### å‘å¾Œå…¼å®¹æ€§
- âš ï¸ `Country.continent` å­—æ®µè¨­ç½®ç‚º `blank=True, null=True`ï¼Œå› æ­¤ç¾æœ‰æ•¸æ“šä¸æœƒå ±éŒ¯
- âš ï¸ ä½†å»ºè­°ç›¡å¿«ç‚ºæ‰€æœ‰åœ‹å®¶æ·»åŠ æ‰€å±¬å¤§é™¸ï¼Œä»¥ç¢ºä¿ URL æ­£å¸¸å·¥ä½œ
- âš ï¸ å¦‚æœåœ‹å®¶æ²’æœ‰é—œè¯å¤§é™¸ï¼Œ`get_absolute_url()` æœƒè¿”å›åŸºæœ¬çš„å¥—ç¥¨åˆ—è¡¨é 

### æ•¸æ“šå®Œæ•´æ€§
ç‚ºç¢ºä¿ç³»çµ±æ­£å¸¸é‹è¡Œï¼Œè«‹ç¢ºä¿ï¼š
1. æ¯å€‹å¤§é™¸éƒ½æœ‰å”¯ä¸€çš„ slug
2. æ¯å€‹åœ‹å®¶éƒ½é—œè¯äº†ä¸€å€‹å¤§é™¸
3. æ¯å€‹åŸå¸‚éƒ½é—œè¯äº†ä¸€å€‹åœ‹å®¶
4. æ¯å€‹å¥—ç¥¨éƒ½é—œè¯äº†ä¸€å€‹åŸå¸‚

### URL çµæ§‹è®Šæ›´å½±éŸ¿
å¦‚æœæ‚¨ä¹‹å‰æœ‰å…¶ä»–æ¨¡æ¿æˆ–è¦–åœ–ä½¿ç”¨äº†èˆŠçš„ URL çµæ§‹ï¼Œè«‹ç¢ºä¿æ›´æ–°ï¼š

**èˆŠçµæ§‹ï¼š**
```django
{% url 'main:package_detail' country_slug city_slug package_slug %}
```

**æ–°çµæ§‹ï¼š**
```django
{% url 'main:package_detail' continent_slug country_slug city_slug package_slug %}
```

## ç®¡ç†ç•Œé¢åŠŸèƒ½

### å¤§é™¸ç®¡ç†
- åˆ—è¡¨é¡¯ç¤ºï¼šåç¨±ã€è‹±æ–‡åç¨±ã€slugã€ç‹€æ…‹ã€å‰µå»ºæ™‚é–“
- å¯æŒ‰ç‹€æ…‹å’Œå‰µå»ºæ™‚é–“ç¯©é¸
- å¯æœç´¢åç¨±ã€è‹±æ–‡åç¨±ã€slug
- æ”¯æŒæ‰¹é‡å•Ÿç”¨/ç¦ç”¨

### åœ‹å®¶ç®¡ç†
- åˆ—è¡¨æ–°å¢ã€Œæ‰€å±¬å¤§é™¸ã€æ¬„ä½
- å¯æŒ‰å¤§é™¸ç¯©é¸åœ‹å®¶
- æ’åºæ–¹å¼æ”¹ç‚ºï¼šå¤§é™¸ â†’ åœ‹å®¶

### å¥—ç¥¨ç®¡ç†
- ç¯©é¸å™¨æ–°å¢ã€Œå¤§é™¸ã€é¸é …
- å¯æŒ‰ï¼šå¤§é™¸ â†’ åœ‹å®¶ â†’ åŸå¸‚ å±¤ç´šç¯©é¸

## å¸¸è¦‹å•é¡Œ

### Q: é·ç§»å¾Œç¾æœ‰å¥—ç¥¨é‚„èƒ½è¨ªå•å—ï¼Ÿ
A: éœ€è¦å…ˆç‚ºæ‰€æœ‰åœ‹å®¶æ·»åŠ æ‰€å±¬å¤§é™¸ï¼Œå¦å‰‡æŸäº› URL å¯èƒ½ç„¡æ³•æ­£å¸¸å·¥ä½œã€‚

### Q: å¦‚ä½•æ‰¹é‡ç‚ºåœ‹å®¶æ·»åŠ å¤§é™¸ï¼Ÿ
A: å¯ä»¥ä½¿ç”¨ Django shellï¼š
```python
from main.models import Continent, Country

# å‰µå»ºå¤§é™¸
asia = Continent.objects.create(name="äºæ´²", name_en="Asia", slug="asia")

# æ‰¹é‡æ›´æ–°åœ‹å®¶
Country.objects.filter(name__in=["æ—¥æœ¬", "æ³°åœ‹", "é¦¬ä¾†è¥¿äº"]).update(continent=asia)
```

### Q: èˆŠçš„ URL é‚„èƒ½ä½¿ç”¨å—ï¼Ÿ
A: ä¸èƒ½ã€‚æ‰€æœ‰ URL ç¾åœ¨éƒ½éœ€è¦åŒ…å« continent_slugã€‚è«‹æ›´æ–°æ‰€æœ‰å¼•ç”¨ã€‚

## ä¸‹ä¸€æ­¥å»ºè­°

1. âœ… åŸ·è¡Œæ•¸æ“šåº«é·ç§»
2. âœ… æ·»åŠ å¤§é™¸æ•¸æ“š
3. âœ… ç‚ºæ‰€æœ‰åœ‹å®¶é—œè¯å¤§é™¸
4. âœ… æ¸¬è©¦æ–°çš„ URL çµæ§‹
5. ğŸ“ æ›´æ–° `package_detail.html` æ¨¡æ¿ï¼ˆå¦‚éœ€è¦ï¼‰
6. ğŸ“ å‰µå»ºå¤§é™¸åˆ—è¡¨é é¢ï¼ˆå¯é¸ï¼‰
7. ğŸ“ æ·»åŠ éºµåŒ…å±‘å°èˆªï¼ˆå¯é¸ï¼‰

## æŠ€è¡“æ”¯æŒ

å¦‚æœ‰ä»»ä½•å•é¡Œï¼Œè«‹æª¢æŸ¥ï¼š
- Django æ—¥èªŒ
- æ•¸æ“šåº«é€£æ¥
- æ‰€æœ‰æ¨¡å‹é—œè¯æ˜¯å¦æ­£ç¢ºè¨­ç½®

